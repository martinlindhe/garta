language: rust
rust:
#  - stable
#  - beta
  - nightly
env:
  - GTK=3.18
addons:
  apt:
    packages:
      - libgtk-3-dev
      - libcurl4-openssl-dev
      - libelf-dev
      - libdw-dev
      - binutils-dev
      - cmake
    sources:
      - kalakris-cmake
cache:
  apt: true
  directories:
    - target/debug/deps
    - target/debug/build      
#matrix:
#  allow_failures:
#    - rust: nightly


before_script:
  - |
    cargo install cargo-travis &&
    export PATH=$HOME/.cargo/bin:$PATH

script:
  - BUNDLE="gtk-3.18.1-2"
  - FEATURES=gtk_3_18
  - WD="$PWD"
  - cd "$HOME"
  - curl -LO "https://github.com/gkoz/gtk-bootstrap/releases/download/$BUNDLE/deps.txz"
  - tar -xf deps.txz
  - cd "$WD"
  - export PKG_CONFIG_PATH="$HOME/local/lib/pkgconfig"
  - cargo build --features "$FEATURES"
  - cargo test --features "$FEATURES"

after_success:
# measure code coverage and upload to coveralls.io
  - cargo coveralls

notifications:
  email: false

